<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merdeka Day</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow-x: hidden;
            font-family: Hepta Slab, sans-serif;
            font-weight: 500;
            background: url('image/background13.png') no-repeat center center fixed; /* Set the background image */
            background-size: cover; /* Make sure the background image covers the entire page */
            color: #5D4037;
        }

        @media only screen and (max-width: 480px) {
            body, html {
                background-position: 3% center !important; /* Focus on the left part of the image */
                background-size: cover; /* Ensure the image covers the screen while focusing on the left */
                background-repeat: no-repeat;
            }

            .section img {
                width: 90%;
                height: auto;
                max-height: 50%; /* Adjust image max height for better fit on mobile */
            }

            .section p {
                width: 90%; /* Adjust width of paragraph text */
                padding: 15px; /* Reduce padding for smaller screens */
                font-size: 0.8em; /* Adjust font size */
            }

            .section h2 {
                font-size: 1.5em; /* Adjust header size */
                margin-bottom: 15px; /* Reduce margin below header */
            }
        }

        @media only screen and (max-width: 768px) {
            body, html {
                background-position: 3% center !important; /* Focus on the left part of the image */
                background-size: cover; /* Ensure the image covers the screen while focusing on the left */
                background-repeat: no-repeat;
            }

            .section img {
                width: 80%;
                height: auto;
                max-height: 60%; /* Adjust image max height for tablets */
            }

            .section p {
                width: 80%; /* Adjust width of paragraph text */
                padding: 18px; /* Slightly reduce padding */
                font-size: 0.9em; /* Adjust font size */
            }

            .section h2 {
                font-size: 1.75em; /* Adjust header size */
                margin-bottom: 18px; /* Adjust margin below header */
            }
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100%;
            overflow: hidden;
            position: relative;
            z-index: 1;
            transition: margin-top 1s ease-out;
        }
        .content {
            width: 100%;
            height: 100%;
            position: relative;
            color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .section {
            position: absolute;
            top: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            opacity: 0;
            transform: translateX(100%); /* Start off-screen to the right */
            transition: opacity 1.5s ease-in-out, transform 1.5s ease-in-out; /* Smoother transition */
            will-change: transform, opacity;
        }
        .section img {
            width: 60%;
            height: auto;
            max-height: 60%;
            display: block;
            margin: 0 auto;
        }
        .section p {
            width: 60%;
            color: #000;
            padding: 20px 0;
            text-align: center;
            margin-top: 20px;
            border-radius: 10px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
            background-color: #FFFFFF;
            word-wrap: break-word;
            margin-bottom: 20px;
            white-space: normal;
            line-height: 1.5;
        }

        .section h2 {
            font-size: 2em;
            margin-bottom: 20px;
        }

        .photo-source {
            font-size: 0.7em; /* Smaller font size for the photo source */
            color: #555; /* Optional: Change the color to a lighter shade */
            display: block; /* Optional: Makes the span behave like a block-level element */
            margin-top: 10px; /* Optional: Adds some space above the photo source */
            font-style: italic; /* Optional: Italicize the photo source */
        }

        /* Active Section Style */
        .section.active {
            opacity: 1;
            transform: translateX(0); /* Center the section */
        }
        /* Slide-in from the left */
        .section.slide-in-left {
            transform: translateX(-100%);
        }
        /* Slide-in from the right */
        .section.slide-in-right {
            transform: translateX(100%);
        }
        /* Slide-out to the left */
        .section.slide-out-left {
            transform: translateX(-100%);
            opacity: 0;
        }
        /* Slide-out to the right */
        .section.slide-out-right {
            transform: translateX(100%);
            opacity: 0;
        }
    </style>
</head>
<body>
    <div class="container" id="container">
        <div class="content">
            <div class="section active" id="section1">
                <h2>1511</h2>
                <img src="image/merdeka1.png" alt="Merdeka Day Image 1">
                <p>
                    Pada tahun 1511, Melaka jatuh ke tangan Portugis dan bermula dari tahun inilah Tanah Melayu berada dalam era penjajahan di mana Belanda menakluki Tanah Melayu pada tahun 1641 sebelum British mengambil alih pada tahun 1824.
                    <br>
                    <span class="photo-source">Photo source: about-history.com/portuguese-and-dutch-colonization-of-malacca/</span>
                </p>
            </div>
            <div class="section" id="section2">
                <h2>1941-1945</h2>
                <img src="image/merdeka2.png" alt="Merdeka Day Image 2">
                <p>
                    Kemudian, Jepun menakluk Tanah Melayu pada tahun 1941 dan menduduki Tanah Melayu sehingga tahun 1945, setelah menyerah kalah ekoran pengeboman bom atom ke atas Hiroshima dan Nagasaki.
                    <br>
                    <span class="photo-source">Photo source: The National Archives of Malaysia 1999/0000423g1</span>
                </p>
            </div>
            <div class="section" id="section3">
                <h2>1946</h2>
                <img src="image/merdeka3.png" alt="Merdeka Day Image 3">
                <p>
                    British kembali ke Tanah Melayu pada tahun 1946. Pada 1 April 1946, British menubuhkan Malayan Union tetapi gagasan ini mendapat tentangan hebat daripada orang Melayu kerana ia menghapuskan institusi diraja dan hak keistimewaan orang-orang Melayu.
                    <br>
                    <span class="photo-source">Photo source: British Government, Public domain, via Wikimedia Commons</span>
                </p>
            </div>
            <div class="section" id="section4">
                <h2>1952</h2>
                <img src="image/merdeka4.png" alt="Merdeka Day Image 4">
                <p>
                    Tunku Abdul Rahman Putra Al-Haj telah menaikkan semangat perjuangan penduduk Tanah Melayu untuk mendapat kemerdekaan dengan pembentukan Parti Perikatan (UMNO dan MCA) pada 1952. Ini merupakan detik permulaan pihak British menyedari kemungkinan besar penduduk Tanah Melayu boleh mentadbir negara mereka sendiri.
                    <br>
                    <span class="photo-source">Photo source: Screenshot from Road to Nationhood Documentary produced by Rack Focus Films in association with the New Straits Times Press.</span>
                </p>
            </div>
            <div class="section" id="section5">
                <h2>1955</h2>
                <img src="image/merdeka5.png" alt="Merdeka Day Image 5">
                <p>
                    Kemungkinan ini menjadi kenyataan pada tahun 1955 apabila Parti Perikatan yang kini juga melibatkan MIC menang besar dalam pilihanraya 1955. Ini membawa kepada kejayaan Perjanjian London yang ditandatangani pada 8 Februari 1956, sekaligus memberi petanda bahawa Persekutuan Tanah Melayu akan merdeka pada 31 Ogos 1957.
                    <br>
                    <span class="photo-source">Photo source: Arkib Negara Malaysia</span>
                </p>
            </div>
            <div class="section" id="section6">
                <h2>1963</h2>
                <img src="image/merdeka6.png" alt="Merdeka Day Image 6">
                <p>
                    Perjanjian Malaysia telah ditandatangani pada 9 Julai 1963. Menerusinya, Sarawak, Sabah dan Singapura membentuk negara baharu dengan Tanah Melayu berkuatkuasa 16 September 1963.
                    <br>
                    <span class="photo-source">Photo source: Compilation reference from the publication, Expressions of Merdeka Malaysia by Abdul Mutalib Razak, Original photo: NSTP (RCHC), Newsclippings: Utusan Melayu, 16 September 1963</span>
                </p>
            </div>
        </div>
    </div>

    <script>
        let currentSection = 0;
        const sections = document.querySelectorAll('.section');
        let isThrottled = false;

        function showSection(index) {
            sections.forEach((section, i) => {
                section.classList.remove('active', 'slide-out-left', 'slide-out-right', 'slide-in-left', 'slide-in-right');

                if (i === index) {
                    section.classList.add('active');
                } else if (i < index) {
                    section.classList.add('slide-out-left');
                } else if (i > index) {
                    section.classList.add('slide-in-right');
                }
            });
        }

        function handleScroll(event) {
            if (isThrottled) return;
            isThrottled = true;
            setTimeout(() => {
                isThrottled = false;
            }, 1000); // Throttle the scroll event

            const previousSection = currentSection;

            if (event.deltaY > 0 && currentSection < sections.length - 1) {
                currentSection += 1;
                console.log('Scrolling down to section', currentSection);
                showSection(currentSection);
            } else if (event.deltaY < 0 && currentSection > 0) {
                currentSection -= 1;
                console.log('Scrolling up to section', currentSection);
                showSection(currentSection);
            } else if (event.deltaY > 0 && currentSection === sections.length - 1) {
                console.log('Scrolling down to next section');
                window.parent.postMessage('nextSection', '*');
            } else if (event.deltaY < 0 && currentSection === 0) {
                console.log('Scrolling up to previous section');
                window.parent.postMessage('prevSection', '*');
            }

            if (previousSection > currentSection) {
                sections[currentSection].classList.add('slide-in-left');
            }

            showSection(currentSection);
        }

        // Handling touch events for scrolling on mobile devices
        let xDown = null;
        let yDown = null;

        function handleTouchStart(evt) {
            const firstTouch = evt.touches[0];
            xDown = firstTouch.clientX;
            yDown = firstTouch.clientY;
        }

        function handleTouchMove(evt) {
            if (!xDown || !yDown) {
                return;
            }

            const xUp = evt.touches[0].clientX;
            const yUp = evt.touches[0].clientY;

            const xDiff = xDown - xUp;
            const yDiff = yDown - yUp;

            const previousSection = currentSection;

            if (Math.abs(xDiff) > Math.abs(yDiff)) {
                // Detect horizontal swipe (optional, not used in this case)
            } else {
                if (yDiff > 0 && currentSection < sections.length - 1) {
                    // Up swipe (scroll down)
                    currentSection += 1;
                    console.log('Swiping up to section', currentSection);
                } else if (yDiff < 0 && currentSection > 0) {
                    // Down swipe (scroll up)
                    currentSection -= 1;
                    console.log('Swiping down to section', currentSection);
                } else if (yDiff > 0 && currentSection === sections.length - 1) {
                    console.log('Swiping up to next section');
                    window.parent.postMessage('nextSection', '*');
                } else if (yDiff < 0 && currentSection === 0) {
                    console.log('Swiping down to previous section');
                    window.parent.postMessage('prevSection', '*');
                }

                // Ensure correct animation direction
                if (previousSection > currentSection) {
                    sections[previousSection].classList.add('slide-out-right');
                    sections[currentSection].classList.remove('slide-in-right');
                    sections[currentSection].classList.add('slide-in-left');
                } else if (previousSection < currentSection) {
                    sections[previousSection].classList.add('slide-out-left');
                    sections[currentSection].classList.remove('slide-in-left');
                    sections[currentSection].classList.add('slide-in-right');
                }

                showSection(currentSection);
            }

            xDown = null;
            yDown = null;
        }

        window.onload = () => {
            showSection(currentSection);
        };

        window.addEventListener('wheel', handleScroll);

        // Add touch event listeners
        window.addEventListener('touchstart', handleTouchStart, false);
        window.addEventListener('touchmove', handleTouchMove, false);

        window.addEventListener('message', function(event) {
            console.log('Message received in section2:', event.data);
            if (event.data === 'nextSlide') {
                if (currentSection < sections.length - 1) {
                    currentSection += 1;
                    showSection(currentSection);
                } else {
                    window.parent.postMessage('nextSection', '*');
                }
            } else if (event.data === 'prevSlide') {
                if (currentSection > 0) {
                    currentSection -= 1;
                    showSection(currentSection);
                } else {
                    window.parent.postMessage('prevSection', '*');
                }
            }
        });
    </script>
</body>
</html>
